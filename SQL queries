create table ga_session_views
(
    session_id text, -- id associated with a particular session (see here for more information https://support.google.com/analytics/answer/2731565?hl=en)
    hit_timestamp timestamp, - time (to the minute level) when a user hit a page
    node_id integer, -- id of page that was hit
    pageviews integer - number of times the user hit a page
);

create table ga_session_features
(
    session_id text, -- unique session identifier, matches with session_id from ga_session_views, primary key
    medium text, -- way the user came to the site including: organic, direct, referral
    device_category text, -- type of device the user used options are: mobile, desktop, tablet
    browser text -- type of browser user used:
);

# Write a query that shows how many pageviews occurred in the last week

SELECT SUM(pageviews)
FROM ga_session_views
WHERE hit_timestamp > DATE_SUB(CURRENT_TIMESTAMP, INTERVAL 7 day)

# How many sessions have organic as a medium?

SELECT COUNT(SESSION_ID)
FROM ga_session_features
WHERE medium = 'organic';

# 
